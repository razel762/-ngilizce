<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Burak & Harun | 9/N Global Tournament</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&family=Kalam:wght@700&display=swap" rel="stylesheet">
    
    <style>
        :root { 
            --bronze: #cd7f32; --iron: #bdc3c7; --gold: #f1c40f; 
            --diamond: #3498db; --elit: #e74c3c; --neon: #ff0000; 
        }
        * { box-sizing: border-box; margin: 0; padding: 0; user-select: none; outline: none; }
        body { font-family: 'Poppins', sans-serif; background: #000; color: #fff; height: 100vh; display: flex; justify-content: center; align-items: center; overflow: hidden; position: relative; }

        /* JUMPSCARE Sƒ∞STEMƒ∞ - TAKILMAZ */
        @keyframes shake { 0%, 100% { transform: translate(0,0); } 25% { transform: translate(-15px, 10px); } 50% { transform: translate(15px, -10px); } }
        .jumpscare-active { background: #700 !important; animation: shake 0.1s infinite !important; }
        #ghost { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0); z-index: 9999; font-size: 220px; opacity: 0; transition: 0.1s; pointer-events: none; }
        .ghost-show { transform: translate(-50%, -50%) scale(2.5) !important; opacity: 1 !important; }

        /* ANA TASARIM */
        .glass-panel { 
            border: 3px solid var(--neon); 
            box-shadow: 0 0 50px var(--neon), inset 0 0 20px rgba(255,0,0,0.5); 
            background: rgba(0, 0, 0, 0.96); 
            border-radius: 40px; 
            padding: 40px; 
            width: 95%; 
            max-width: 480px; 
            text-align: center; 
            z-index: 100;
        }

        .tournament-header { 
            background: linear-gradient(135deg, #200, #000, #200); 
            border: 2px solid gold; 
            padding: 20px; 
            border-radius: 20px; 
            margin-bottom: 30px; 
            box-shadow: 0 0 25px rgba(255,0,0,0.4);
        }

        input { 
            width: 100%; padding: 20px; border-radius: 18px; border: none; 
            margin-bottom: 15px; text-align: center; font-size: 22px; 
            font-weight: 800; background: #fff; color: #000; 
        }

        .btn { 
            width: 100%; padding: 20px; border-radius: 18px; border: none; 
            font-size: 18px; font-weight: 900; cursor: pointer; 
            transition: 0.2s; background: var(--neon); color: #fff;
            box-shadow: 0 5px 0 #800;
        }
        .btn:active { transform: translateY(4px); box-shadow: none; }

        /* R√úTBE VE Lƒ∞STE */
        .rank-badge { font-size: 11px; font-weight: 900; padding: 6px 12px; border-radius: 12px; color: #000; min-width: 100px; text-align: center; }
        .r-bronze { background: var(--bronze); color: #fff; }
        .r-iron { background: var(--iron); }
        .r-gold { background: var(--gold); }
        .r-diamond { background: var(--diamond); color: #fff; }
        .r-elit { background: var(--elit); color: #fff; box-shadow: 0 0 20px red; }

        .dev-tag { background: linear-gradient(45deg, #f00, gold, #f00); background-size: 200%; color: #fff; padding: 3px 10px; border-radius: 6px; font-size: 11px; font-weight: 900; margin-left: 8px; animation: flow 2s linear infinite; }
        @keyframes flow { 0% { background-position: 0%; } 100% { background-position: 200%; } }

        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.99); z-index: 1000; flex-direction: column; align-items: center; justify-content: center; padding: 25px; }
        .scroll-list { overflow-y: auto; max-height: 400px; width: 100%; margin: 20px 0; }
        .list-item { display: flex; justify-content: space-between; align-items: center; background: rgba(255,255,255,0.08); padding: 15px; margin-bottom: 10px; border-radius: 15px; border-left: 5px solid var(--neon); }
    </style>
</head>
<body>

<div id="ghost">üëª</div>
<audio id="snd-jump" src="https://www.soundboard.com/handler/DownLoadTrack.ashx?cliptitle=FNAF+Jumpscare&filename=mz/MzU3MDU1NTM1MzcwNTY3_97v8_2b_2f_2fmXw.mp3"></audio>
<audio id="snd-win" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>

<div id="view-auth" class="glass-panel">
    <div class="tournament-header">
        <h2 style="font-size: 15px; color: gold; letter-spacing: 2px;">9/N GLOBAL TOURNAMENT</h2>
        <p style="font-size: 10px; color: #aaa;">BY BURAK & HARUN</p>
    </div>
    <input type="text" id="user-input" placeholder="ƒ∞Sƒ∞M YAZ">
    <button class="btn" onclick="app.login()">KAYIT OL VE Gƒ∞R</button>
</div>

<div id="view-menu" class="glass-panel" style="display:none;">
    <h1 id="welcome-msg" style="font-size: 32px; color: var(--neon); margin-bottom: 25px;">Selam!</h1>
    <button class="btn" onclick="app.startGame('solo')" style="margin-bottom: 10px; height: 80px; font-size: 22px;">TEKLƒ∞ OYNA</button>
    <button class="btn" onclick="app.showVS()" style="background: #2ecc71; margin-bottom: 10px;">1 VS 1 MODU</button>
    <button class="btn" onclick="app.showLeaderboard()" style="background: #3498db;">D√úNYA SIRALAMASI</button>
</div>

<div id="view-game" class="glass-panel" style="display:none;">
    <div style="display:flex; justify-content: space-between; font-weight: 900; font-size: 20px;">
        <span style="color:red">S√úRE: <b id="game-time">30</b></span>
        <span style="color:gold">SKOR: <b id="game-score">0</b></span>
    </div>
    <div id="vs-header" style="color:cyan; font-size: 14px; margin-top: 5px; font-weight: bold;"></div>
    <div id="word-display" style="font-family:'Kalam'; font-size: 55px; margin: 30px 0; text-shadow: 0 0 15px red;">...</div>
    <input type="text" id="ans-input" placeholder="ƒ∞ngilizcesini Yaz">
</div>

<div id="view-board" class="overlay">
    <div class="glass-panel" style="max-height: 90vh; display: flex; flex-direction: column;">
        <h2 style="color:gold;">üèÜ GLOBAL RANKING</h2>
        <div id="board-content" class="scroll-list"></div>
        <button class="btn" onclick="location.reload()">TEKRAR OYNA / √áIKI≈û</button>
    </div>
</div>

<script>
    const WORD_BANK = [
        {tr:"Gelenek",en:"tradition"},{tr:"√áevre",en:"environment"},{tr:"Gelecek",en:"future"},{tr:"Teknoloji",en:"technology"},{tr:"Eƒüitim",en:"education"},{tr:"Ba≈üarƒ±",en:"success"},{tr:"Yetenek",en:"ability"},{tr:"Macera",en:"adventure"},{tr:"Miras",en:"heritage"},{tr:"Kirlilik",en:"pollution"},{tr:"D√ºr√ºst",en:"honest"},{tr:"C√∂mert",en:"generous"},{tr:"ƒ∞nat√ßƒ±",en:"stubborn"},{tr:"Kibar",en:"polite"},{tr:"Zeki",en:"intelligent"},{tr:"Geli≈üim",en:"improvement"},{tr:"Ke≈üfetmek",en:"explore"},{tr:"Saƒülƒ±klƒ±",en:"healthy"},{tr:"√ñnemli",en:"important"},{tr:"Deneyim",en:"experience"}
    ]; // Buraya 100 kelime eklenebilir.

    const app = {
        user: "", score: 0, time: 30, timer: null, currentWord: null,
        db: null,

        init: function() {
            const fbConfig = { databaseURL: "https://burak-harun-9n-default-rtdb.firebaseio.com" };
            firebase.initializeApp(fbConfig);
            this.db = firebase.database();
            
            document.getElementById('ans-input').addEventListener('keypress', (e) => {
                if(e.key === 'Enter') this.checkAns();
            });
        },

        login: function() {
            const val = document.getElementById('user-input').value.trim();
            if(!val) return;
            this.user = val;
            document.getElementById('view-auth').style.display = 'none';
            document.getElementById('view-menu').style.display = 'block';
            document.getElementById('welcome-msg').innerText = "Selam, " + val;
        },

        startGame: function(mode) {
            if(mode === 'vs') {
                const opp = prompt("Rakip ƒ∞smi:");
                if(!opp) return;
                document.getElementById('vs-header').innerText = this.user + " VS " + opp;
            }
            document.getElementById('view-menu').style.display = 'none';
            document.getElementById('view-game').style.display = 'block';
            this.score = 0; this.time = 30;
            this.nextWord();
            this.timer = setInterval(() => {
                this.time--;
                document.getElementById('game-time').innerText = this.time;
                if(this.time <= 0) this.endGame();
            }, 1000);
        },

        nextWord: function() {
            this.currentWord = WORD_BANK[Math.floor(Math.random() * WORD_BANK.length)];
            document.getElementById('word-display').innerText = this.currentWord.tr.toUpperCase();
            document.getElementById('ans-input').value = "";
            document.getElementById('ans-input').focus();
        },

        checkAns: function() {
            const val = document.getElementById('ans-input').value.toLowerCase().trim();
            if(val === this.currentWord.en) {
                this.score += 50; this.time += 2;
                document.getElementById('game-score').innerText = this.score;
                document.getElementById('snd-win').play();
                confetti({ particleCount: 50, spread: 70, origin: { y: 0.6 } });
                this.nextWord();
            } else {
                this.triggerJump();
            }
        },

        triggerJump: function() {
            document.body.classList.add('jumpscare-active');
            document.getElementById('ghost').classList.add('ghost-show');
            document.getElementById('snd-jump').play();
            setTimeout(() => {
                document.body.classList.remove('jumpscare-active');
                document.getElementById('ghost').classList.remove('ghost-show');
            }, 600);
            this.nextWord();
        },

        endGame: function() {
            clearInterval(this.timer);
            // Zorla temizle (Donma Korumasƒ±)
            document.body.classList.remove('jumpscare-active');
            document.getElementById('ghost').classList.remove('ghost-show');

            let r = "BRONZ", c = "r-bronze";
            if(this.score >= 2000) { r = "ELƒ∞T"; c = "r-elit"; }
            else if(this.score >= 1000) { r = "ELMAS"; c = "r-diamond"; }
            else if(this.score >= 500) { r = "ALTIN"; c = "r-gold"; }
            else if(this.score >= 200) { r = "DEMƒ∞R"; c = "r-iron"; }

            this.db.ref('final_ranking_v4/' + this.user).set({
                n: this.user, s: this.score, r: r, c: c
            }).then(() => this.showLeaderboard());
        },

        showLeaderboard: function() {
            document.getElementById('view-game').style.display = 'none';
            document.getElementById('view-menu').style.display = 'none';
            document.getElementById('view-board').style.display = 'flex';

            this.db.ref('final_ranking_v4').orderByChild('s').limitToLast(25).once('value', (snap) => {
                let data = [];
                snap.forEach(child => data.push(child.val()));
                data.sort((a,b) => b.s - a.s);
                
                document.getElementById('board-content').innerHTML = data.map((p, i) => `
                    <div class="list-item">
                        <span><b>${i+1}.</b> ${p.n} ${(p.n.toLowerCase().includes('developer') || p.n === 'Burak') ? '<span class="dev-tag">DEVELOPER</span>' : ''}</span>
                        <div>
                            <b style="color:gold; margin-right:10px;">${p.s}</b>
                            <span class="rank-badge ${p.c}">${p.r}</span>
                        </div>
                    </div>
                `).join('');
            });
        },

        showVS: function() { this.startGame('vs'); }
    };

    app.init();
</script>
</body>
</html>
